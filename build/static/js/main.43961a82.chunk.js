(this["webpackJsonpclackur-app"]=this["webpackJsonpclackur-app"]||[]).push([[0],{49:function(e){e.exports=JSON.parse('{"domain":"dev-1232de9a.auth0.com","clientId":"5cRhsF01fg86eVqlghTP7RGGfOVAAhwy","audience":"clackurAuthAPI"}')},79:function(e,t,a){e.exports=a(99)},92:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),i=a(6),s=a.n(i),u=a(12),l=a(47),m=a(24),p=a(33),d=a(8),f=a(63),h="https://clackur-backend.herokuapp.com",b=function(){return window.history.replaceState({},document.title,window.location.pathname)},g=r.a.createContext(),v=function(){return Object(n.useContext)(g)},E=function(e){var t=e.children,a=e.onRedirectCallback,c=void 0===a?b:a,o=Object(l.a)(e,["children","onRedirectCallback"]),i=Object(n.useState)(),m=Object(d.a)(i,2),v=m[0],E=m[1],j=Object(n.useState)(),x=Object(d.a)(j,2),O=x[0],k=x[1],w=Object(n.useState)(),y=Object(d.a)(w,2),S=y[0],C=y[1],A=Object(n.useState)(!0),N=Object(d.a)(A,2),T=N[0],P=N[1],I=Object(n.useState)(!1),F=Object(d.a)(I,2),R=F[0],U=F[1];Object(n.useEffect)((function(){(function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n,r,i,u,l,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)(o);case 2:if(t=e.sent,C(t),!window.location.search.includes("code=")||!window.location.search.includes("state=")){e.next=10;break}return e.next=7,t.handleRedirectCallback();case 7:a=e.sent,n=a.appState,c(n);case 10:return e.next=12,t.isAuthenticated();case 12:if(r=e.sent,E(r),!r){e.next=28;break}return e.next=17,t.getUser();case 17:return i=e.sent,e.next=20,t.getTokenSilently();case 20:return u=e.sent,e.next=23,fetch("".concat(h,"/users/login"),{method:"PATCH",body:JSON.stringify({name:i.nickname,email:i.email}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)}});case 23:return l=e.sent,e.next=26,l.json();case 26:(m=e.sent).newUser?k(Object(p.a)(Object(p.a)({},i),{},{userId:m.newUser.id})):k(Object(p.a)(Object(p.a)({},i),{},{userId:m.user.id}));case 28:P(!1);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var B=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},U(!0),e.prev=2,e.next=5,S.loginWithPopup(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:return e.prev=10,U(!1),e.finish(10);case 13:return e.next=15,S.getUser();case 15:a=e.sent,k(a),E(!0);case 18:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,S.handleRedirectCallback();case 3:return e.next=5,S.getUser();case 5:t=e.sent,P(!1),E(!0),k(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(g.Provider,{value:{isAuthenticated:v,user:O,loading:T,popupOpen:R,loginWithPopup:B,handleRedirectCallback:W,getIdTokenClaims:function(){return S.getIdTokenClaims.apply(S,arguments)},loginWithRedirect:function(){return S.loginWithRedirect.apply(S,arguments)},getTokenSilently:function(){return S.getTokenSilently.apply(S,arguments)},getTokenWithPopup:function(){return S.getTokenWithPopup.apply(S,arguments)},logout:function(){return S.logout.apply(S,arguments)}}},t)},j=function(e){var t=e.component,a=e.path,c=Object(l.a)(e,["component","path"]),o=v(),i=o.loading,p=o.isAuthenticated,d=o.loginWithRedirect;Object(n.useEffect)((function(){i||p||function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({appState:{targetUrl:window.location.pathname}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[i,p,d,a]);return r.a.createElement(m.a,Object.assign({path:a,render:function(e){return!0===p?r.a.createElement(t,e):null}},c))},x=a(135),O=a(137),k=a(50),w=a(138),y=a(132),S=(a(92),a(22)),C=Object(y.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function A(){var e=C(),t=v(),a=t.isAuthenticated,n=t.loginWithRedirect,c=t.logout;return r.a.createElement("div",{className:e.root},r.a.createElement(x.a,{position:"static"},r.a.createElement(O.a,null,r.a.createElement(k.a,{variant:"h6",className:e.title},r.a.createElement("div",null,r.a.createElement("a",{href:"/",id:"navbar-logo"},r.a.createElement("img",{alt:"clackur logo",src:"https://clackurbucket.s3.us-east-2.amazonaws.com/1589431160842",height:"40",width:"40"}),"\xa0lackur"))),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{to:"/"},r.a.createElement(w.a,null,"Home")),r.a.createElement(S.a,{to:"/posts/new"},r.a.createElement(w.a,null,"New Post")),r.a.createElement(S.a,{to:"/profile"},r.a.createElement(w.a,null,"Profile"))),!a&&r.a.createElement(w.a,{onClick:function(){return n({})}},"Log in"),a&&r.a.createElement(w.a,{onClick:function(){return c()}},"Log out"))))}var N=a(139),T=a(140),P=a(143),I=a(142),F=a(141),R=a(144),U=a(43),B=a.n(U),W=a(45),z=a.n(W),J=Object(y.a)({root:{maxWidth:345,background:"#FAF5FB"}});function V(e){var t=e.post,a=Object(n.useState)(t.Votes.filter((function(e){return e.upVote})).length),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(t.Votes.filter((function(e){return e.downVote})).length),m=Object(d.a)(l,2),p=m[0],f=m[1],b=v(),g=b.user,E=b.getTokenSilently,j=J(),x=function(){var e=Object(u.a)(s.a.mark((function e(a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=12;break}return e.next=3,E();case 3:return n=e.sent,e.next=6,fetch("".concat(h,"/posts/").concat(t.id,"/upvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({userId:g.userId})});case 6:204===(r=e.sent).status&&i(o-1),201===r.status&&i(o+1),206===r.status&&(i(o+1),f(p-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(s.a.mark((function e(a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=12;break}return e.next=3,E();case 3:return n=e.sent,e.next=6,fetch("".concat(h,"/posts/").concat(t.id,"/downvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({userId:g.userId})});case 6:204===(r=e.sent).status&&f(p-1),201===r.status&&f(p+1),206===r.status&&(f(p+1),i(o-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(N.a,{className:j.root,style:{margin:"10px"}},r.a.createElement(S.a,{to:{pathname:"/posts/".concat(t.id),post:t}},r.a.createElement(T.a,null,r.a.createElement(F.a,{component:"img",alt:t.title,height:"180",image:t.imageUrl,title:t.title}),r.a.createElement(I.a,null,r.a.createElement(k.a,{variant:"h5",component:"h2"},t.title)))),r.a.createElement(P.a,null,r.a.createElement(R.a,{onClick:x},r.a.createElement(B.a,null),r.a.createElement(k.a,{variant:"subtitle1"},o)),r.a.createElement(R.a,{onClick:O},r.a.createElement(z.a,null),r.a.createElement(k.a,{variant:"subtitle1"},-1*p))))}a(94),a(95);function _(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"loading-images"},r.a.createElement("img",{alt:"mxclear",src:"https://deskthority.net/wiki/images/2/25/Mx_clear_illustration.gif",className:"img-responsive"}),r.a.createElement("img",{alt:"mxblue",src:"https://deskthority.net/wiki/images/0/02/Mx_blue_illustration.gif",className:"img-responsive"}),r.a.createElement("img",{alt:"mxred",src:"https://deskthority.net/wiki/images/3/3a/Mx_red_illustration.gif",className:"img-responsive"})),r.a.createElement("h2",{className:"loading-text"},"Loading..."))}var D=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),i=Object(d.a)(o,2),l=i[0],m=i[1],p=v().user;return Object(n.useEffect)((function(){setTimeout((function(){m(!0)}),3500),function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(h,"/posts"));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=a.posts,c(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}()()}),[]),p?r.a.createElement(r.a.Fragment,null,!l&&r.a.createElement(_,null),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home-welcome"},"Welcome, ",p.name),r.a.createElement("div",{className:"posts-container"},a.map((function(e){return r.a.createElement(V,{post:e,key:e.id})}))))):r.a.createElement(r.a.Fragment,null,!l&&r.a.createElement(_,null),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"posts-container"},a.map((function(e){return r.a.createElement(V,{post:e,key:e.id})})))))},H=function(){var e=Object(n.useState)(!1),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),i=Object(d.a)(o,2),l=i[0],m=i[1],p=v().getTokenSilently,f=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p();case 3:return t=e.sent,e.next=6,fetch("".concat(h,"/api/external"),{headers:{Authorization:"Bearer ".concat(t)}});case 6:return a=e.sent,e.next=9,a.json();case 9:n=e.sent,c(!0),m(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"External API"),r.a.createElement("button",{onClick:f},"Ping API"),a&&r.a.createElement("code",null,JSON.stringify(l,null,2)))},L=a(148),G=a(68),M=a(69),q=(a(96),Object(y.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),minWidth:400,width:"60vw",background:"#FAF5FB"}},form:{width:"60vw"}}})));function $(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),i=Object(d.a)(o,2),l=i[0],m=i[1],p=Object(n.useState)(""),f=Object(d.a)(p,2),b=f[0],g=f[1],E=Object(n.useState)(""),j=Object(d.a)(E,2),x=j[0],O=j[1],k=Object(n.useRef)(new FormData),y=v(),S=y.user,C=y.getTokenSilently,A=q(),N=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.current.set("file",t[0]),c(t.map((function(e){return e.name}))),m(t.map((function(e){return URL.createObjectURL(e)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==l.length){e.next=4;break}return alert("please upload a photo"),e.abrupt("return");case 4:return e.next=6,C();case 6:return a=e.sent,e.next=9,fetch("".concat(h,"/posts/image/upload"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:k.current});case 9:return n=e.sent,e.next=12,n.json();case 12:return r=e.sent,e.next=15,fetch("".concat(h,"/posts/new"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({categoryId:1,userId:S.userId,title:b,description:x,imageUrl:r.imageUrl,public:!0})});case 15:e.sent.ok&&(window.location.href="/");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{id:"new-post-form-container",onSubmit:T},r.a.createElement(M.a,null,r.a.createElement("form",{className:"".concat(A.root," new-post-form"),autoComplete:"off"},r.a.createElement(L.a,{id:"new-post-title",label:"Add a Title",variant:"outlined",value:b,onChange:function(e){return g(e.target.value)},required:!0}),r.a.createElement(L.a,{id:"new-post-description",label:"Add a Description",variant:"outlined",value:x,onChange:function(e){return O(e.target.value)},required:!0}),r.a.createElement(M.a,{className:"drop-zone"},r.a.createElement(G.a,{onDrop:N,accept:"image/*"},(function(e){var t=e.getRootProps,a=e.getInputProps;return r.a.createElement("div",t({className:"dropzone"}),r.a.createElement("input",a()),r.a.createElement("p",{style:{padding:"10px"}},"Drag/drop image, or click to select image"))}))),r.a.createElement("div",null,"File: ",a.map((function(e){return r.a.createElement("li",{key:e},e)})),r.a.createElement("div",null,"Preview:"),l.map((function(e){return r.a.createElement("img",{alt:b,key:e,src:e,width:"100%"})}))),r.a.createElement(w.a,{type:"submit",variant:"contained",color:"primary"},"Post"))))}a(97);var K=a(145),Q=a(149),X=a(48),Y=a(66),Z=a.n(Y),ee=Object(y.a)((function(e){return{root:{maxHeight:"60%",maxWidth:"60%"},media:{height:0,paddingTop:"56.25%"},avatar:{backgroundColor:X.a[500]}}}));function te(e){var t=e.location,a=Object(n.useState)({}),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(0),m=Object(d.a)(l,2),p=m[0],f=m[1],b=Object(n.useState)(0),g=Object(d.a)(b,2),E=g[0],j=g[1],x=ee(),O=v(),w=O.user,y=O.getTokenSilently;Object(n.useEffect)((function(){(function(){var e=Object(u.a)(s.a.mark((function e(){var a,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(h).concat(t.pathname));case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,r=n.post,i(r),f(r.Votes.filter((function(e){return e.upVote})).length),j(r.Votes.filter((function(e){return e.downVote})).length);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.pathname]);var S=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=12;break}return e.next=3,y();case 3:return a=e.sent,e.next=6,fetch("".concat(h,"/posts/").concat(o.id,"/upvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({userId:w.userId})});case 6:204===(n=e.sent).status&&f(p-1),201===n.status&&f(p+1),206===n.status&&(f(p+1),j(E-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=12;break}return e.next=3,y();case 3:return a=e.sent,e.next=6,fetch("".concat(h,"/posts/").concat(o.id,"/downvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({userId:w.userId})});case 6:204===(n=e.sent).status&&j(E-1),201===n.status&&j(E+1),206===n.status&&(j(E+1),f(p-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.User?r.a.createElement("div",{id:"single-post-detail-card-container"},r.a.createElement(N.a,{className:x.root},r.a.createElement(K.a,{avatar:r.a.createElement(Q.a,{"aria-label":"recipe",className:x.avatar},o.User.name.slice(0,2)),action:r.a.createElement(R.a,{"aria-label":"settings"},r.a.createElement(Z.a,null)),title:r.a.createElement(k.a,{variant:"h5",component:"h2"},o.title),subheader:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"by ",o.User.name),r.a.createElement("div",null,Date(o.createdAt)))}),r.a.createElement(F.a,{component:"img",height:"50%",alt:o.title,image:o.imageUrl,title:o.title}),r.a.createElement(I.a,null,r.a.createElement(k.a,{variant:"body2",color:"textSecondary",component:"p"},o.description)),r.a.createElement(P.a,{disableSpacing:!0},r.a.createElement(R.a,{onClick:S},r.a.createElement(B.a,null),r.a.createElement(k.a,{variant:"subtitle1"},p)),r.a.createElement(R.a,{onClick:C},r.a.createElement(z.a,null),r.a.createElement(k.a,{variant:"subtitle1"},-1*E))))):r.a.createElement("div",null,"loading")}a(98);var ae=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],o=v(),i=o.loading,l=o.user;return Object(n.useEffect)((function(){l&&function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(h,"/posts/user/").concat(l.userId));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=a.posts,c(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}()()}),[l]),i||!l?r.a.createElement("div",null,"Loading..."):r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"user-info-container"},r.a.createElement("img",{src:l.picture,alt:"Profile",style:{"border-radius":"50%"}}),r.a.createElement("h3",null,l.name),r.a.createElement("h1",null,"My Posts")),r.a.createElement("div",{className:"posts-container"},a.map((function(e){return r.a.createElement(V,{post:e,key:e.id})}))))},ne=a(16),re=Object(ne.a)(),ce=a(67),oe=a(146),ie=a(147),se=Object(ce.a)({palette:{primary:{main:"#9B9EBA"},secondary:{main:"#64b5f6"},background:{default:"#DEE2FF"}}});var ue=function(){return r.a.createElement(oe.a,{theme:se},r.a.createElement(ie.a,null),r.a.createElement("div",{className:"App"},r.a.createElement(m.b,{history:re},r.a.createElement("header",null,r.a.createElement(A,null)),r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/",exact:!0,component:D}),r.a.createElement(j,{path:"/profile",component:ae}),r.a.createElement(j,{path:"/external-api",component:H}),r.a.createElement(j,{exact:!0,path:"/posts/new",component:$}),r.a.createElement(m.a,{path:"/posts/:id",component:te})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=a(49);o.a.render(r.a.createElement(E,{domain:le.domain,client_id:le.clientId,redirect_uri:window.location.origin,audience:le.audience,onRedirectCallback:function(e){re.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)}},r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[79,1,2]]]);
//# sourceMappingURL=main.43961a82.chunk.js.map