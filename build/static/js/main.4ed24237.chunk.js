(this["webpackJsonpclackur-app"]=this["webpackJsonpclackur-app"]||[]).push([[0],{49:function(e){e.exports=JSON.parse('{"domain":"dev-1232de9a.auth0.com","clientId":"5cRhsF01fg86eVqlghTP7RGGfOVAAhwy","audience":"clackurAuthAPI"}')},79:function(e,t,a){e.exports=a(98)},92:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),i=a(6),u=a.n(i),s=a(12),l=a(47),p=a(24),m=a(33),d=a(8),f=a(63),h=function(){return window.history.replaceState({},document.title,window.location.pathname)},b=r.a.createContext(),v=function(){return Object(n.useContext)(b)},g=function(e){var t=e.children,a=e.onRedirectCallback,c=void 0===a?h:a,o=Object(l.a)(e,["children","onRedirectCallback"]),i=Object(n.useState)(),p=Object(d.a)(i,2),v=p[0],g=p[1],E=Object(n.useState)(),k=Object(d.a)(E,2),j=k[0],O=k[1],x=Object(n.useState)(),w=Object(d.a)(x,2),y=w[0],S=w[1],C=Object(n.useState)(!0),A=Object(d.a)(C,2),T=A[0],P=A[1],I=Object(n.useState)(!1),N=Object(d.a)(I,2),F=N[0],R=N[1];Object(n.useEffect)((function(){(function(){var e=Object(s.a)(u.a.mark((function e(){var t,a,n,r,i,s,l,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)(o);case 2:if(t=e.sent,S(t),!window.location.search.includes("code=")||!window.location.search.includes("state=")){e.next=10;break}return e.next=7,t.handleRedirectCallback();case 7:a=e.sent,n=a.appState,c(n);case 10:return e.next=12,t.isAuthenticated();case 12:if(r=e.sent,g(r),!r){e.next=28;break}return e.next=17,t.getUser();case 17:return i=e.sent,e.next=20,t.getTokenSilently();case 20:return s=e.sent,e.next=23,fetch("https://clackur-backend.herokuapp.com/users/login",{method:"PATCH",body:JSON.stringify({name:i.nickname,email:i.email}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 23:return l=e.sent,e.next=26,l.json();case 26:(p=e.sent).newUser?O(Object(m.a)(Object(m.a)({},i),{},{userId:p.newUser.id})):O(Object(m.a)(Object(m.a)({},i),{},{userId:p.user.id}));case 28:P(!1);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var U=function(){var e=Object(s.a)(u.a.mark((function e(){var t,a,n=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},R(!0),e.prev=2,e.next=5,y.loginWithPopup(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:return e.prev=10,R(!1),e.finish(10);case 13:return e.next=15,y.getUser();case 15:a=e.sent,O(a),g(!0);case 18:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,y.handleRedirectCallback();case 3:return e.next=5,y.getUser();case 5:t=e.sent,P(!1),g(!0),O(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(b.Provider,{value:{isAuthenticated:v,user:j,loading:T,popupOpen:F,loginWithPopup:U,handleRedirectCallback:B,getIdTokenClaims:function(){return y.getIdTokenClaims.apply(y,arguments)},loginWithRedirect:function(){return y.loginWithRedirect.apply(y,arguments)},getTokenSilently:function(){return y.getTokenSilently.apply(y,arguments)},getTokenWithPopup:function(){return y.getTokenWithPopup.apply(y,arguments)},logout:function(){return y.logout.apply(y,arguments)}}},t)},E=function(e){var t=e.component,a=e.path,c=Object(l.a)(e,["component","path"]),o=v(),i=o.loading,m=o.isAuthenticated,d=o.loginWithRedirect;Object(n.useEffect)((function(){i||m||function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({appState:{targetUrl:window.location.pathname}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[i,m,d,a]);return r.a.createElement(p.a,Object.assign({path:a,render:function(e){return!0===m?r.a.createElement(t,e):null}},c))},k=a(134),j=a(136),O=a(50),x=a(137),w=a(131),y=(a(92),a(22)),S=Object(w.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function C(){var e=S(),t=v(),a=t.isAuthenticated,n=t.loginWithRedirect,c=t.logout;return r.a.createElement("div",{className:e.root},r.a.createElement(k.a,{position:"static"},r.a.createElement(j.a,null,r.a.createElement(O.a,{variant:"h6",className:e.title},r.a.createElement("a",{href:"/",id:"navbar-logo"},r.a.createElement("img",{alt:"clackur logo",src:"https://clackurbucket.s3.us-east-2.amazonaws.com/1589431160842",height:"40",width:"40"}),"\xa0lackur")),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{to:"/"},r.a.createElement(x.a,null,"Home")),r.a.createElement(y.a,{to:"/posts/new"},r.a.createElement(x.a,null,"New Post")),r.a.createElement(y.a,{to:"/profile"},r.a.createElement(x.a,null,"Profile"))),!a&&r.a.createElement(x.a,{onClick:function(){return n({})}},"Log in"),a&&r.a.createElement(x.a,{onClick:function(){return c()}},"Log out"))))}var A=a(138),T=a(139),P=a(142),I=a(141),N=a(140),F=a(143),R=a(43),U=a.n(R),B=a(45),W=a.n(B),z=Object(w.a)({root:{maxWidth:345,background:"#FAF5FB"}});function J(e){var t=e.post,a=Object(n.useState)(t.Votes.filter((function(e){return e.upVote})).length),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(t.Votes.filter((function(e){return e.downVote})).length),p=Object(d.a)(l,2),m=p[0],f=p[1],h=v(),b=h.user,g=h.getTokenSilently,E=z(),k=function(){var e=Object(s.a)(u.a.mark((function e(a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=12;break}return e.next=3,g();case 3:return n=e.sent,e.next=6,fetch("https://clackur-backend.herokuapp.com/posts/".concat(t.id,"/upvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({userId:b.userId})});case 6:204===(r=e.sent).status&&i(o-1),201===r.status&&i(o+1),206===r.status&&(i(o+1),f(m-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(s.a)(u.a.mark((function e(a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=12;break}return e.next=3,g();case 3:return n=e.sent,e.next=6,fetch("https://clackur-backend.herokuapp.com/posts/".concat(t.id,"/downvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({userId:b.userId})});case 6:204===(r=e.sent).status&&f(m-1),201===r.status&&f(m+1),206===r.status&&(f(m+1),i(o-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(A.a,{className:E.root,style:{margin:"10px"}},r.a.createElement(y.a,{to:{pathname:"/posts/".concat(t.id),post:t}},r.a.createElement(T.a,null,r.a.createElement(N.a,{component:"img",alt:t.title,height:"180",image:t.imageUrl,title:t.title}),r.a.createElement(I.a,null,r.a.createElement(O.a,{variant:"h5",component:"h2"},t.title)))),r.a.createElement(P.a,null,r.a.createElement(F.a,{onClick:k},r.a.createElement(U.a,null),r.a.createElement(O.a,{variant:"subtitle1"},o)),r.a.createElement(F.a,{onClick:j},r.a.createElement(W.a,null),r.a.createElement(O.a,{variant:"subtitle1"},-1*m))))}function V(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{alt:"mxblue",src:"../views/images/mxblue.gif"}))}a(94);var D=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],o=v(),i=o.user,l=o.loading;return Object(n.useEffect)((function(){(function(){var e=Object(s.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://clackur-backend.herokuapp.com/posts");case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=a.posts,c(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}})()()}),[]),i?l?r.a.createElement(V,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home-welcome"},"Welcome, ",i.name),r.a.createElement("div",{className:"posts-container"},a.map((function(e){return r.a.createElement(J,{post:e,key:e.id})})))):r.a.createElement("div",{className:"posts-container"},a.map((function(e){return r.a.createElement(J,{post:e,key:e.id})})))},H=function(){var e=Object(n.useState)(!1),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),i=Object(d.a)(o,2),l=i[0],p=i[1],m=v().getTokenSilently,f=function(){var e=Object(s.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m();case 3:return t=e.sent,e.next=6,fetch("https://clackur-backend.herokuapp.com/api/external",{headers:{Authorization:"Bearer ".concat(t)}});case 6:return a=e.sent,e.next=9,a.json();case 9:n=e.sent,c(!0),p(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"External API"),r.a.createElement("button",{onClick:f},"Ping API"),a&&r.a.createElement("code",null,JSON.stringify(l,null,2)))},L=a(147),G=a(68),q=a(69),_=(a(95),Object(w.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),minWidth:400,width:"60vw",background:"#FAF5FB"}},form:{width:"60vw"}}})));function M(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),i=Object(d.a)(o,2),l=i[0],p=i[1],m=Object(n.useState)(""),f=Object(d.a)(m,2),h=f[0],b=f[1],g=Object(n.useState)(""),E=Object(d.a)(g,2),k=E[0],j=E[1],O=Object(n.useRef)(new FormData),w=v(),y=w.user,S=w.getTokenSilently,C=_(),A=function(){var e=Object(s.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.current.set("file",t[0]),c(t.map((function(e){return e.name}))),p(t.map((function(e){return URL.createObjectURL(e)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==l.length){e.next=4;break}return alert("please upload a photo"),e.abrupt("return");case 4:return e.next=6,S();case 6:return a=e.sent,e.next=9,fetch("https://clackur-backend.herokuapp.com/posts/image/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:O.current});case 9:return n=e.sent,e.next=12,n.json();case 12:return r=e.sent,e.next=15,fetch("https://clackur-backend.herokuapp.com/posts/new",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({categoryId:1,userId:y.userId,title:h,description:k,imageUrl:r.imageUrl,public:!0})});case 15:e.sent.ok&&(window.location.href="/");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{id:"new-post-form-container",onSubmit:T},r.a.createElement(q.a,null,r.a.createElement("form",{className:"".concat(C.root," new-post-form"),autoComplete:"off"},r.a.createElement(L.a,{id:"new-post-title",label:"Add a Title",variant:"outlined",value:h,onChange:function(e){return b(e.target.value)},required:!0}),r.a.createElement(L.a,{id:"new-post-description",label:"Add a Description",variant:"outlined",value:k,onChange:function(e){return j(e.target.value)},required:!0}),r.a.createElement(q.a,{className:"drop-zone"},r.a.createElement(G.a,{onDrop:A,accept:"image/*"},(function(e){var t=e.getRootProps,a=e.getInputProps;return r.a.createElement("div",t({className:"dropzone"}),r.a.createElement("input",a()),r.a.createElement("p",{style:{padding:"10px"}},"Drag/drop image, or click to select image"))}))),r.a.createElement("div",null,"File: ",a.map((function(e){return r.a.createElement("li",{key:e},e)})),r.a.createElement("div",null,"Preview:"),l.map((function(e){return r.a.createElement("img",{alt:h,key:e,src:e,width:"100%"})}))),r.a.createElement(x.a,{type:"submit",variant:"contained",color:"primary"},"Post"))))}a(96);var $=a(144),K=a(148),Q=a(48),X=a(66),Y=a.n(X),Z=Object(w.a)((function(e){return{root:{maxHeight:"60%",maxWidth:"60%"},media:{height:0,paddingTop:"56.25%"},avatar:{backgroundColor:Q.a[500]}}}));function ee(e){var t=e.location,a=Object(n.useState)({}),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(0),p=Object(d.a)(l,2),m=p[0],f=p[1],h=Object(n.useState)(0),b=Object(d.a)(h,2),g=b[0],E=b[1],k=Z(),j=v(),x=j.user,w=j.getTokenSilently;Object(n.useEffect)((function(){(function(){var e=Object(s.a)(u.a.mark((function e(){var a,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://clackur-backend.herokuapp.com".concat(t.pathname));case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,r=n.post,i(r),f(r.Votes.filter((function(e){return e.upVote})).length),E(r.Votes.filter((function(e){return e.downVote})).length);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.pathname]);var y=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=12;break}return e.next=3,w();case 3:return a=e.sent,e.next=6,fetch("https://clackur-backend.herokuapp.com/posts/".concat(o.id,"/upvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({userId:x.userId})});case 6:204===(n=e.sent).status&&f(m-1),201===n.status&&f(m+1),206===n.status&&(f(m+1),E(g-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=12;break}return e.next=3,w();case 3:return a=e.sent,e.next=6,fetch("https://clackur-backend.herokuapp.com/posts/".concat(o.id,"/downvote"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({userId:x.userId})});case 6:204===(n=e.sent).status&&E(g-1),201===n.status&&E(g+1),206===n.status&&(E(g+1),f(m-1)),e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.User?r.a.createElement("div",{id:"single-post-detail-card-container"},r.a.createElement(A.a,{className:k.root},r.a.createElement($.a,{avatar:r.a.createElement(K.a,{"aria-label":"recipe",className:k.avatar},o.User.name.slice(0,2)),action:r.a.createElement(F.a,{"aria-label":"settings"},r.a.createElement(Y.a,null)),title:r.a.createElement(O.a,{variant:"h5",component:"h2"},o.title),subheader:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"by ",o.User.name),r.a.createElement("div",null,Date(o.createdAt)))}),r.a.createElement(N.a,{component:"img",height:"50%",alt:o.title,image:o.imageUrl,title:o.title}),r.a.createElement(I.a,null,r.a.createElement(O.a,{variant:"body2",color:"textSecondary",component:"p"},o.description)),r.a.createElement(P.a,{disableSpacing:!0},r.a.createElement(F.a,{onClick:y},r.a.createElement(U.a,null),r.a.createElement(O.a,{variant:"subtitle1"},m)),r.a.createElement(F.a,{onClick:S},r.a.createElement(W.a,null),r.a.createElement(O.a,{variant:"subtitle1"},-1*g))))):r.a.createElement("div",null,"loading")}a(97);var te=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],o=v(),i=o.loading,l=o.user;return Object(n.useEffect)((function(){l&&function(){var e=Object(s.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://clackur-backend.herokuapp.com/posts/user/".concat(l.userId));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=a.posts,c(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}()()}),[l]),i||!l?r.a.createElement("div",null,"Loading..."):r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"user-info-container"},r.a.createElement("img",{src:l.picture,alt:"Profile",style:{"border-radius":"50%"}}),r.a.createElement("h3",null,l.name),r.a.createElement("h1",null,"My Posts")),r.a.createElement("div",{className:"posts-container"},a.map((function(e){return r.a.createElement(J,{post:e,key:e.id})}))))},ae=a(16),ne=Object(ae.a)(),re=a(67),ce=a(145),oe=a(146),ie=Object(re.a)({palette:{primary:{main:"#9B9EBA"},secondary:{main:"#64b5f6"},background:{default:"#DEE2FF"}}});var ue=function(){return r.a.createElement(ce.a,{theme:ie},r.a.createElement(oe.a,null),r.a.createElement("div",{className:"App"},r.a.createElement(p.b,{history:ne},r.a.createElement("header",null,r.a.createElement(C,null)),r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/",exact:!0,component:D}),r.a.createElement(E,{path:"/profile",component:te}),r.a.createElement(E,{path:"/external-api",component:H}),r.a.createElement(E,{exact:!0,path:"/posts/new",component:M}),r.a.createElement(p.a,{path:"/posts/:id",component:ee})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var se=a(49);o.a.render(r.a.createElement(g,{domain:se.domain,client_id:se.clientId,redirect_uri:window.location.origin,audience:se.audience,onRedirectCallback:function(e){ne.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)}},r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[79,1,2]]]);
//# sourceMappingURL=main.4ed24237.chunk.js.map